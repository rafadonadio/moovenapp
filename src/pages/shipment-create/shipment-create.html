<ion-header>
    <ion-toolbar color="green">
        <ion-buttons left>
            <button ion-button (click)="goBack()">
                <ion-icon name="close"></ion-icon>
            </button>
        </ion-buttons>
        <ion-title>Servicios disponibles</ion-title>
    </ion-toolbar>
    <div class="map-container">
        <div id="maps1"></div>
    </div>
</ion-header>
<ion-content class="shipment-create">

    <ion-card>
        <ion-list *ngIf="pointChange">
            <ion-list-header>Mapa</ion-list-header>
            <ion-item *ngFor="let opt of pointsDropdown; let i = index">
                <h2>{{opt.label}}</h2>
                <button ion-button clear color="green" (click)="setMapCenter(i)" item-right>Seleccionar</button>
            </ion-item>       
        </ion-list>
        <ion-item *ngIf="!pointChange">
            <h2>CABA</h2>
            <button ion-button clear color="green" (click)="changeMapCenter()" item-right>Cambiar</button>
        </ion-item>   
    </ion-card>
    
    <ion-card>
        <ion-list *ngIf="dateChange">
            <ion-list-header>Fecha</ion-list-header>
            <ion-item *ngFor="let date of datesList; let i = index">
                {{date.dateCalendar}} <ion-badge item-right color="green">{{date.keys.length}}</ion-badge>
                <button ion-button clear color="green" item-end (click)="setDate(index)">Seleccionar</button>
            </ion-item>            
        </ion-list>
        <ion-item *ngIf="!dateChange">
            <h2>Hoy</h2>
            <button ion-button clear color="green" item-right (click)="changeDate()">Cambiar</button>
        </ion-item>            
    </ion-card>
    <ion-list *ngFor="let vacant of vacants">
        <ion-item [class.selected]="mapMarkers.selected==vacant.key" no-lines detail-none>
            <h3><span>Cobro</span><b>${{ vacant.data.priceOperatorEarning }}</b> | {{ vacant.data.routeDistanceKm | number: '1.0-0' }} km</h3>
            <h3><span>Fecha</span>{{ vacant.data.pickupTimeFrom | formatdatePipe:'dddd DD/MMM' }}</h3>
            <h3><span>Retirar</span>{{ vacant.data.pickupTimeFrom | formatdatePipe:'HH:mm' }} - {{ vacant.data.pickupTimeTo | formatdatePipe:'HH:mm' }} hs</h3>
            <h3><span>Entregar</span>{{ vacant.data.dropTimeFrom | formatdatePipe:'HH:mm' }} - {{ vacant.data.dropTimeTo | formatdatePipe:'HH:mm' }} hs</h3>
            <button ion-button item-right color="green"
                *ngIf="mapMarkers.selected!==vacant.key" 
                (click)="selectedToggle(vacant)">VER</button>
            <button ion-button item-right color="dark"
                *ngIf="mapMarkers.selected===vacant.key"
                (click)="selectedToggle(vacant)"><ion-icon name="ios-close"></ion-icon></button>
            <button ion-button item-right color="light"
                *ngIf="mapMarkers.selected===vacant.key" 
                (click)="select(vacant.key, vacant.data)">TOMAR</button>
        </ion-item>
    </ion-list>
</ion-content>